## RDMA-testbed
### RDMA-testbed所需材料
- 交换机-交换机（中性-中性\*16）
	- 8\*DAC电缆（100G,2m,中性-中性，万兆通/1sfpcom）
	- 16\*光模块（100G，QSFP28，中性，飞速）
	- 8\*光纤（MTP，OM4，1m，飞速）
- 交换机-Mellanox网卡（中性-Mellanox\*16）
	- 8\*光模块（100G,QSFP28,Mellanox,飞速）
	- 8\*光模块（100G，QSFP28，中性，飞速）
	- 8\*光纤（MPO，OM4，2m，万兆通/1sfpcom）
	- 5\*AOC光缆（100G，3m，中性-Mellanox，万兆通/1sfpcom）
	- 2\*光模块（100G，QSFP28，中性，飞速）、2\*光模块（100G，QSFP28，Mellanox，飞速）、2\*光纤（MTP，OM4，3m，飞速）
	- 1\*光模块（100G，QSFP28，中性，万兆通/1sfpcom）、1\*光模块（100G，QSFP28，Mellanox，万兆通/1sfpcom）、1\*光纤（MPO，OM4，3m，万兆通/1sfpcom）
- 总计
	- 光模块（100G,QSFP28,Mellanox,飞速）\*10 √
	- 光模块（100G，QSFP28，中性，飞速）\*26 √
	- 光模块（100G，QSFP28，中性，万兆通/1sfpcom）\*1 √
	- 光模块（100G，QSFP28，Mellanox，万兆通/1sfpcom）\*1 √
	- 光纤（MPO，OM4，3m，万兆通/1sfpcom）\*1 √
	- 光纤（MPO，OM4，2m，万兆通/1sfpcom）\*8 √
	- 光纤（MTP，OM4，3m，飞速）\*2 √
	- 光纤（MTP，OM4，1m，飞速）\*8 √
	- DAC电缆（100G,2m,中性-中性，万兆通/1sfpcom）\*8 √
	- AOC光缆（100G，3m，中性-Mellanox，万兆通/1sfpcom）\*5 √
### RDMA-testbed拓扑

| ip             | port | PCIe          |
| -------------- | ---- | ------------- |
| 10.150.240.201 | 7/0  | enp153s0f0np0 |
| 10.150.240.202 | 8/0  | enp153s0f1np1 |
| 10.150.240.203 | 10/0 | enp174s0f0np0 |
| 10.150.240.204 | 9/0  | enp174s0f1np1 |
| 10.150.240.211 | 5/0  | enp10s0f0np0  |
| 10.150.240.212 | 6/0  | enp10s0f1np1  |
| 10.150.240.213 | 12/0 | enp173s0f0np0 |
| 10.150.240.214 | 11/0 | enp173s0f1np1 |
| 10.150.240.221 | 3/0  | enp10s0f0np0  |
| 10.150.240.222 | 4/0  | enp10s0f1np1  |
| 10.150.240.223 | 14/0 | enp173s0f0np0 |
| 10.150.240.224 | 13/0 | enp173s0f1np1 |
| 10.150.240.231 | 1/0  | enp10s0f0np0  |
| 10.150.240.232 | 2/0  | enp10s0f1np1  |
| 10.150.240.233 | 16/0 | enp173s0f0np0 |
| 10.150.240.234 | 15/0 | enp173s0f1np1 |
## extra experiment
### 随机丢包
实验初步结果

|            | 1000      | 10000    | 100000   | 1000000  | no loss  |
| ---------- | --------- | -------- | -------- | -------- | -------- |
| mean_small | 1728.622  | 404.418  | 256.625  | 243.433  | 257.176  |
| mean_large | 2094.184  | 1159.794 | 928.069  | 909.798  | 919.574  |
| p99_small  | 17714.336 | 6743.304 | 4898.529 | 4677.402 | 4881.993 |
| p99_large  | 18728.538 | 9335.806 | 7524.924 | 7221.196 | 7355.450 |

### 拥塞丢包
#### random packet spray
实验配置
- DCQCN参数
	- DCQCN_K_MIN = 580
	- DCQCN_K_MAX = 2520
	- DCQCN_P_MAX = 0.1
- buffer size
	- 50000cells->4000cells
### PFC副作用
#### ecmp

TRANSMIT PAUSE STATISTICS (1us count per priority)
1/0                 132 58,922,893          0          0          0          0          0          0          0
2/0                 140 59,179,628          0          0          0          0          0          0          0
3/0                 148          0          0          0          0          0          0          0          0
4/0                 156          0          0          0          0          0          0          0          0
5/0                 164     13,578          0          0          0          0          0          0          0
6/0                 172      1,741          0          0          0          0          0          0          0
7/0                 180          0          0          0          0          0          0          0          0
8/0                 188          0          0          0          0          0          0          0          0
9/0                  56          0          0          0          0          0          0          0          0
10/0                 48          0          0          0          0          0          0          0          0
11/0                 40          0          0          0          0          0          0          0          0
12/0                 32          0          0          0          0          0          0          0          0
13/0                 24          0          0          0          0          0          0          0          0
14/0                 16          0          0          0          0          0          0          0          0
15/0                  8 89,205,395          0          0          0          0          0          0          0
16/0                  0 89,144,420          0          0          0          0          0          0          0
17/0                  4 64,921,438          0          0          0          0          0          0          0
18/0                 12          0          0          0          0          0          0          0          0
19/0                 20 64,899,214          0          0          0          0          0          0          0
20/0                 28          0          0          0          0          0          0          0          0
21/0                 36          0          0          0          0          0          0          0          0
22/0                 44          0          0          0          0          0          0          0          0
23/0                 52          2          0          0          0          0          0          0          0
24/0                 60          0          0          0          0          0          0          0          0
25/0                184          3          0          0          0          0          0          0          0
26/0                176          0          0          0          0          0          0          0          0
27/0                168          0          0          0          0          0          0          0          0
28/0                160          0          0          0          0          0          0          0          0
29/0                144         67          0          0          0          0          0          0          0
30/0                152          0          0          0          0          0          0          0          0
31/0                128 64,323,743          0          0          0          0          0          0          0
32/0                136          0          0          0          0          0          0          0          0

RECEIVE PAUSE STATISTICS (1us count per priority)
1/0                 132          0          0          0          0          0          0          0          0            0
2/0                 140          0          0          0          0          0          0          0          0            0
3/0                 148          0          0          0          0          0          0          0          0            0
4/0                 156          0          0          0          0          0          0          0          0            0
5/0                 164          0          0          0          0          0          0          0          0            0
6/0                 172          0          0          0          0          0          0          0          0            0
7/0                 180          0          0          0          0          0          0          0          0            0
8/0                 188          0          0          0          0          0          0          0          0            0
9/0                  56          0          0          0          0          0          0          0          0            0
10/0                 48          0          0          0          0          0          0          0          0            0
11/0                 40          0          0          0          0          0          0          0          0            0
12/0                 32          0          0          0          0          0          0          0          0            0
13/0                 24          0          0          0          0          0          0          0          0            0
14/0                 16          0          0          0          0          0          0          0          0            0
15/0                  8          0          0          0          0          0          0          0          0            0
16/0                  0          0          0          0          0          0          0          0          0            0
17/0                  4          0          0          0          0          0          0          0          0            0
18/0                 12 64,644,812          0          0          0          0          0          0          0            0
19/0                 20          0          0          0          0          0          0          0          0            0
20/0                 28 64,618,851          0          0          0          0          0          0          0            0
21/0                 36          0          0          0          0          0          0          0          0            0
22/0                 44          0          0          0          0          0          0          0          0            0
23/0                 52          0          0          0          0          0          0          0          0            0
24/0                 60          0          0          0          0          0          0          0          0            0
25/0                184          0          0          0          0          0          0          0          0            0
26/0                176          0          0          0          0          0          0          0          0            0
27/0                168          0          0          0          0          0          0          0          0            0
28/0                160          0          0          0          0          0          0          0          0            0
29/0                144          0          0          0          0          0          0          0          0            0
30/0                152          1          0          0          0          0          0          0          0            0
31/0                128          0          0          0          0          0          0          0          0            0
32/0                136 64,093,213          0          0          0          0          0          0          0            0
#### rps
TRANSMIT PAUSE STATISTICS (1us count per priority)
1/0                 132 89,720,806          0          0          0          0          0          0          0
2/0                 140 90,030,809          0          0          0          0          0          0          0
3/0                 148          0          0          0          0          0          0          0          0
4/0                 156          0          0          0          0          0          0          0          0
5/0                 164 89,794,923          0          0          0          0          0          0          0
6/0                 172 89,015,167          0          0          0          0          0          0          0
7/0                 180          0          0          0          0          0          0          0          0
8/0                 188          0          0          0          0          0          0          0          0
9/0                  56          0          0          0          0          0          0          0          0
10/0                 48          0          0          0          0          0          0          0          0
11/0                 40          0          0          0          0          0          0          0          0
12/0                 32 89,682,153          0          0          0          0          0          0          0
13/0                 24          0          0          0          0          0          0          0          0
14/0                 16          0          0          0          0          0          0          0          0
15/0                  8 89,865,727          0          0          0          0          0          0          0
16/0                  0 89,751,610          0          0          0          0          0          0          0
17/0                  4 94,427,873          0          0          0          0          0          0          0
18/0                 12          0          0          0          0          0          0          0          0
19/0                 20 94,373,668          0          0          0          0          0          0          0
20/0                 28          0          0          0          0          0          0          0          0
21/0                 36 94,366,533          0          0          0          0          0          0          0
22/0                 44          0          0          0          0          0          0          0          0
23/0                 52 94,382,100          0          0          0          0          0          0          0
24/0                 60          0          0          0          0          0          0          0          0
25/0                184 94,357,803          0          0          0          0          0          0          0
26/0                176          0          0          0          0          0          0          0          0
27/0                168 94,358,944          0          0          0          0          0          0          0
28/0                160          0          0          0          0          0          0          0          0
29/0                144 94,370,304          0          0          0          0          0          0          0
30/0                152          0          0          0          0          0          0          0          0
31/0                128 94,372,906          0          0          0          0          0          0          0
32/0                136          0          0          0          0          0          0          0          0

RECEIVE PAUSE STATISTICS (1us count per priority)
1/0                 132          0          0          0          0          0          0          0          0            0
2/0                 140          0          0          0          0          0          0          0          0            0
3/0                 148          0          0          0          0          0          0          0          0            0
4/0                 156          0          0          0          0          0          0          0          0            0
5/0                 164          0          0          0          0          0          0          0          0            0
6/0                 172          0          0          0          0          0          0          0          0            0
7/0                 180          0          0          0          0          0          0          0          0            0
8/0                 188          0          0          0          0          0          0          0          0            0
9/0                  56          0          0          0          0          0          0          0          0            0
10/0                 48          0          0          0          0          0          0          0          0            0
11/0                 40          0          0          0          0          0          0          0          0            0
12/0                 32          0          0          0          0          0          0          0          0            0
13/0                 24          0          0          0          0          0          0          0          0            0
14/0                 16          0          0          0          0          0          0          0          0            0
15/0                  8          0          0          0          0          0          0          0          0            0
16/0                  0          0          0          0          0          0          0          0          0            0
17/0                  4          0          0          0          0          0          0          0          0            0
18/0                 12 68,493,158          0          0          0          0          0          0          0            0
19/0                 20          0          0          0          0          0          0          0          0            0
20/0                 28 68,291,161          0          0          0          0          0          0          0            0
21/0                 36          0          0          0          0          0          0          0          0            0
22/0                 44 68,989,582          0          0          0          0          0          0          0            0
23/0                 52          0          0          0          0          0          0          0          0            0
24/0                 60 69,092,137          0          0          0          0          0          0          0            0
25/0                184          0          0          0          0          0          0          0          0            0
26/0                176 69,642,098          0          0          0          0          0          0          0            0
27/0                168          0          0          0          0          0          0          0          0            0
28/0                160 69,598,690          0          0          0          0          0          0          0            0
29/0                144          0          0          0          0          0          0          0          0            0
30/0                152 69,272,341          0          0          0          0          0          0          0            0
31/0                128          0          0          0          0          0          0          0          0            0
32/0                136 68,915,591          0          0          0          0          0          0          0            0

### slow-restart+incast
### AI workload
## motivation
- rate limit
	- 收到CNP和loss的速率变化
		- 只开启DCQCN
		- 只开启slow start，但设置不同的DCQCN参数
		- 同时开启DCQCN和slow start
